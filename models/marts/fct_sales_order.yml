version: 2

models:
  - name: fct_sales_order
    description: Fact table containing detailed sales data at the line-item level, with key metrics and foreign keys to related dimensions.
    columns:
      - name: sk_sales_order
        description: The primary key for this fact table, created by hashing the sales_order_id and sales_order_detail_id to ensure a unique key for each line item.
        tests:
          - unique
          - not_null
      
      - name: fk_date
        description: A foreign key that links to the date dimension.
        tests:
          - not_null
          - relationships:
              to: ref('dim_date')
              field: sk_date
      
      - name: fk_credit_card
        description: A foreign key that links to the credit card dimension.
        tests:
          - relationships:
              to: ref('dim_credit_card')
              field: sk_credit_card
      
      - name: fk_customer
        description: A foreign key that links to the customer dimension.
        tests:
          - not_null
          - relationships:
              to: ref('dim_customer')
              field: sk_customer
      
      - name: fk_territory
        description: A foreign key that links to the territory dimension.
        tests:
          - relationships:
              to: ref('dim_territory')
              field: sk_territory
      
      - name: fk_product
        description: A foreign key that links to the product dimension.
        tests:
          - not_null
          - relationships:
              to: ref('dim_product')
              field: sk_product
      
      - name: fk_reason
        description: A foreign key that links to the sales reason dimension.
        tests:
          - relationships:
              to: ref('dim_reason')
              field: sk_reason
      
      - name: order_status
        description: Textual description of the order's status.

      - name: online_order
        description: Boolean indicating if the order was placed online (True) or not (False).

      - name: order_quantity
        description: The quantity of the product ordered.

      - name: unit_price
        description: The price per unit of the product.
      
      - name: unit_price_discount
        description: The discount rate applied per unit of the product.

      - name: had_discount
        description: Boolean indicating whether a discount was applied to the item (True) or not (False).

      - name: gross_total
        description: The total amount before discount for the order item.
      
      - name: net_total
        description: The total amount after discount for the order item.
      
      - name: discount_amount
        description: The total amount of discount applied to the order item.

      - name: sub_total
        description: The subtotal of the entire sales order before freight and tax.

      - name: prorated_freight
        description: The portion of the total freight cost for the order.
      
      - name: prorated_tax
        description: The portion of the total tax amount for the order.

      - name: line_total
        description: The final total for the line item, including net total, prorated freight, and prorated tax.
      
      - name: total_due
        description: The final amount due for the entire sales order (subtotal + freight + tax).

      - name: order_date
        description: The date when the order was placed.
      
      - name: ship_date
        description: The date when the order was shipped.
      
      - name: due_date
        description: The date when the order payment is due.